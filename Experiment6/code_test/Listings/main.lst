C51 COMPILER V9.60.0.0   MAIN                                                              12/23/2019 20:53:14 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          /*******************************************************
   2          
   3          程序功能：LCD12864液晶测试
   4          
   5          开发环境：Keil3
   6          
   7          硬件环境：CEPARK多功能开发学习板/实验箱（2013版），STC12C5A60S2，11.0592M晶振
   8                                                                                                                                                                                                     
   9          接线说明：单片机P1口与底板JP41排针相连，分别为：P10-D0, P11-D1，P12-D2，P13-D3，P14-D4，P15-D5，P16-D6，P1
             -7-D7；
  10                    单片机P34~P37口与底板JP36相连，分别为：P34-RS,P35-RW,P36-EN，P37-CS1，CS2悬空         
  11          
  12          跳线说明：无
  13          
  14          实验现象：液晶屏显示图片
  15          
  16                                                                                   
  17          论坛支持：http://bbs.cepark.com
  18          
  19          淘宝店铺：http://cepark.taobao.com
  20          
  21          作者：cepark 
  22          
  23          时间：2013-01-01（元旦快乐！）
  24          
  25          
  26          
  27          *******************************************************/
  28          
  29          
  30          
  31          #include <REG52.H>
  32          
  33          sbit LCD12864_RS  =  P3^4;       //RS控制引脚
  34          sbit LCD12864_RW  =  P3^3;       //RW控制引脚
  35          sbit LCD12864_EN  =  P3^2;       //EN控制引脚
  36          sbit LCD12864_PSB  =  P3^0;       //模式选择引脚，ST7920控制器，1为8位并行接口，0为串行接口
  37          
  38          #define LCDPORT P1              //数据引脚
  39          
  40          
  41          void LCD12864_Init(void);                 //LCD12864初始化函数
  42          void LCD12864_WriteInfomation(unsigned char ucData,bit bComOrData);        
  43                  //向LCD12864写入数据，bComOrData为1时写入的是数据，0时写入的是命令
  44          
  45          void LCD12864_CheckBusy(void);          //忙检测函数
  46          void LCD12864_DisplayImage(unsigned char code *ucImage);
  47          void Delay(unsigned int uiCount);
  48          
  49          unsigned char code ucPic[]={
  50                                  0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
  51                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  52                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  53                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
C51 COMPILER V9.60.0.0   MAIN                                                              12/23/2019 20:53:14 PAGE 2   

  54                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  55                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  56                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0xFF,0xF0,0x00,0x01,
  57                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x18,0x00,0x01,
  58                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xBF,0xFF,0xDC,0x00,0x01,
  59                                  0x80,0x00,0x1F,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0xBF,0xFF,0xBC,0x00,0x01,
  60                                  0x80,0x00,0x30,0x00,0x01,0x80,0x00,0x00,0x00,0x00,0x01,0x7F,0xFF,0xB8,0x00,0x01,
  61                                  0x80,0x00,0x30,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x01,0x7F,0xFF,0x78,0x00,0x01,
  62                                  0x80,0x00,0x19,0xFF,0xFE,0xC0,0x00,0x00,0x00,0x00,0x02,0xFF,0xFF,0x70,0x00,0x01,
  63                                  0x80,0x00,0x18,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x02,0xFF,0xFE,0xF0,0x00,0x01,
  64                                  0x80,0x00,0x0C,0x01,0xFF,0x60,0x00,0x00,0x00,0x00,0x05,0xFF,0xFE,0xE0,0x00,0x01,
  65                                  0x80,0x00,0x0C,0x7F,0xD0,0x20,0x00,0x00,0x00,0x00,0x05,0xFF,0xFD,0xE0,0x00,0x01,
  66                                  0x80,0x00,0x06,0x00,0x0F,0xB0,0x00,0x00,0x00,0x00,0x0B,0xFF,0xFD,0xC0,0x00,0x01,
  67                                  0x80,0x00,0x06,0x03,0xFC,0x10,0x00,0x00,0x00,0x00,0x0B,0xFF,0xFB,0xC0,0x00,0x01,
  68                                  0x80,0x00,0x03,0x1F,0x00,0x18,0x00,0x00,0x00,0x00,0x17,0xFF,0xFB,0x80,0x00,0x01,
  69                                  0x80,0x00,0x03,0x00,0x00,0x08,0x00,0x00,0x00,0x00,0x17,0xFF,0xF7,0x80,0x00,0x01,
  70                                  0x80,0x00,0x01,0x80,0x00,0x0C,0x00,0x00,0x00,0x00,0x17,0xFF,0xF7,0x00,0x00,0x01,
  71                                  0x80,0x00,0x01,0x80,0x00,0x04,0x00,0x00,0x00,0x00,0x09,0xFF,0xEF,0x00,0x00,0x01,
  72                                  0x80,0x00,0x00,0xC0,0x00,0xF6,0x00,0x00,0x00,0x00,0x06,0x7F,0xEE,0x00,0x00,0x01,
  73                                  0x80,0x00,0x00,0xC0,0x03,0xC2,0x00,0x00,0x00,0x00,0x01,0x9F,0xDE,0x00,0x00,0x01,
  74                                  0x80,0x00,0x00,0x60,0x00,0x3B,0x00,0x00,0x00,0x00,0x00,0x67,0xDF,0x00,0x00,0x01,
  75                                  0x80,0x00,0x00,0x60,0x00,0xE3,0x00,0x00,0x00,0x00,0x00,0x19,0xBF,0x00,0x00,0x01,
  76                                  0x80,0x00,0x00,0x30,0x03,0x8E,0x00,0x00,0x00,0x00,0x00,0x06,0x3F,0x00,0x00,0x01,
  77                                  0x80,0x00,0x00,0x30,0x06,0x3C,0x00,0x00,0x00,0x00,0x00,0x01,0xFF,0x00,0x00,0x01,
  78                                  0x80,0x00,0x00,0x18,0x00,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x01,
  79                                  0x80,0x00,0x00,0x18,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x0F,0x7F,0x80,0x00,0x01,
  80                                  0x80,0x00,0x00,0x0C,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x1F,0xC0,0x00,0x01,
  81                                  0x80,0x00,0x00,0x0C,0x3C,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x07,0xE0,0x00,0x01,
  82                                  0x80,0x00,0x00,0x06,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0x1F,0xE0,0x00,0x01,
  83                                  0x80,0x00,0x00,0x07,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0x3F,0xC0,0x00,0x01,
  84                                  0x80,0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7E,0xFF,0x00,0x00,0x01,
  85                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0xFC,0x00,0x00,0x01,
  86                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0xF0,0x00,0x00,0x01,
  87                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0xC0,0x00,0x00,0x01,
  88                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  89                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  90                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  91                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  92                                  0x80,0x05,0x40,0x88,0x04,0x01,0x08,0x00,0x00,0x0A,0x81,0x10,0x04,0x00,0x20,0x01,
  93                                  0x80,0x79,0x21,0x08,0x02,0x21,0x49,0x00,0x00,0xF2,0x42,0x10,0x04,0x47,0x10,0x01,
  94                                  0x80,0x09,0x07,0xDF,0x7F,0xF7,0xAA,0x00,0x00,0x12,0x0F,0xBE,0x7F,0xE5,0xFE,0x01,
  95                                  0x80,0x7F,0xF4,0x51,0x08,0x81,0x2C,0x00,0x00,0xFF,0xE8,0xA2,0x44,0x47,0x00,0x01,
  96                                  0x80,0x09,0x04,0x61,0x08,0x81,0x7F,0x00,0x00,0x12,0x08,0xC2,0x7F,0xC5,0x4A,0x01,
  97                                  0x80,0x0B,0x24,0x51,0x08,0x83,0x81,0x00,0x00,0x16,0x48,0xA2,0x44,0x45,0x6A,0x01,
  98                                  0x80,0x1D,0x47,0xC9,0x05,0x05,0x01,0x00,0x00,0x3A,0x8F,0x92,0x44,0x47,0x52,0x01,
  99                                  0x80,0x68,0x84,0x49,0x05,0x05,0x7F,0x00,0x00,0xD1,0x08,0x92,0x7F,0xC5,0x6A,0x01,
 100                                  0x80,0x09,0x94,0x41,0x02,0x01,0x01,0x00,0x00,0x13,0x28,0x82,0x44,0x05,0x4A,0x01,
 101                                  0x80,0x0E,0x57,0xC1,0x0D,0x81,0x01,0x00,0x00,0x1C,0xAF,0x82,0x04,0x29,0x42,0x01,
 102                                  0x80,0x38,0x34,0x4E,0x70,0x71,0x7F,0x00,0x00,0x70,0x68,0x9C,0x03,0xEB,0x7E,0x01,
 103                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 104                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 105                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 106                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 107                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 108                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 109                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 110                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 111                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 112                                  0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
 113                                  0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,};//图像数据
 114          
 115          /******************************************************************************
C51 COMPILER V9.60.0.0   MAIN                                                              12/23/2019 20:53:14 PAGE 3   

 116          函数名称：main
 117          函数功能：主函数，程序如路口
 118          入口参数：无
 119          返回值：无
 120          备注：无
 121          *******************************************************************************/
 122          void main(void)
 123          {
 124   1              LCD12864_Init();   //初始化液晶
 125   1              
 126   1              LCD12864_DisplayImage(ucPic);
 127   1              while(1);
 128   1      
 129   1      }
 130          
 131          /******************************************************************************
 132          函数名称：LCD12864_WriteInfomation
 133          函数功能：向LCD12864写入命令或者数据
 134          入口参数：ucData-要写入液晶的数据或者命令的内容
 135                            bComOrData-命令或者数据的标志位选择，0或者1，其中
 136                                  1：写入的是数据
 137                                  0：写入的是命令
 138          返回值：无
 139          备注：无
 140          *******************************************************************************/
 141          void LCD12864_WriteInfomation(unsigned char ucData,bit bComOrData)
 142          {
 143   1              LCD12864_CheckBusy();   //忙检测
 144   1              LCD12864_RW = 0;        //拉低RW
 145   1              LCD12864_RS = bComOrData;       //根据标志位判断写入的是命令还是数据
 146   1              Delay(10);                                //延时，等待操作
 147   1              LCDPORT = ucData;                 //将数据送至数据端口
 148   1              LCD12864_EN = 1;                  //使能信号
 149   1              Delay(10);                                //延时
 150   1              LCD12864_EN = 0;                //按照时序来操作
 151   1              Delay(10);
 152   1      }
 153          
 154          /******************************************************************************
 155          函数名称：LCD12864_Init
 156          函数功能：LCD12864液晶初始化
 157          入口参数：无
 158          返回值：无
 159          备注：无
 160          *******************************************************************************/
 161          void LCD12864_Init(void)
 162          {
 163   1              Delay(400);//延时
 164   1              LCD12864_PSB = 1;       //8位并口工作模式
 165   1              Delay(150);//延时
 166   1      
 167   1      
 168   1              LCD12864_WriteInfomation(0x36,0); //基本指令集
 169   1              Delay(150);
 170   1              LCD12864_WriteInfomation(0x36,0);  //显示设置
 171   1              Delay(150);
 172   1              LCD12864_WriteInfomation(0x3E,0);       //光标设置
 173   1              Delay(150);
 174   1              LCD12864_WriteInfomation(0x0c,0);       //游标设置
 175   1              Delay(150);
 176   1              LCD12864_WriteInfomation(0x01,0);  //清屏
 177   1              Delay(150);
C51 COMPILER V9.60.0.0   MAIN                                                              12/23/2019 20:53:14 PAGE 4   

 178   1      }
 179          
 180          /******************************************************************************
 181          函数名称：LCD12864_CheckBusy
 182          函数功能：忙检测
 183          入口参数：无
 184          返回值：无
 185          备注：使用变量i做计时，避免液晶在死循环处停滞。
 186          *******************************************************************************/
 187          void LCD12864_CheckBusy(void)
 188          {
 189   1              unsigned char i = 250;  //局部变量
 190   1              LCD12864_RS = 0;          //拉低
 191   1              LCD12864_RW = 1;          //拉高
 192   1              LCD12864_EN = 1;          //使能
 193   1              while((i > 0) && (P0 & 0x80))i--;  //判断忙标志位
 194   1              LCD12864_EN = 0;          //释放
 195   1      }
 196          
 197          /******************************************************************************
 198          函数名称：LCD12864_DisplayImage
 199          函数功能：显示一副图像
 200          入口参数：无
 201          返回值：无
 202          备注：无
 203          *******************************************************************************/
 204          void LCD12864_DisplayImage(unsigned char code *ucImage)
 205          {
 206   1              unsigned char i,j;
 207   1              for(i = 0;i < 32;i++)
 208   1              {
 209   2                      LCD12864_WriteInfomation((0x80 + i),0);
 210   2                      LCD12864_WriteInfomation(0x80,0);
 211   2                      for(j = 0;j < 16;j++)
 212   2                      {
 213   3                              LCD12864_WriteInfomation(*ucImage,1);
 214   3                              ucImage++;
 215   3                      }
 216   2              }
 217   1      
 218   1              for(i = 0;i < 32;i++)
 219   1              {
 220   2                      LCD12864_WriteInfomation((0x80 + i),0);
 221   2                      LCD12864_WriteInfomation(0x88,0);
 222   2                      for(j = 0;j < 16;j++)
 223   2                      {
 224   3                              LCD12864_WriteInfomation(*ucImage,1);
 225   3                              ucImage++;
 226   3                      }
 227   2              }
 228   1      }
 229          
 230          /******************************************************************************
 231          函数名称：Delay
 232          函数功能：延时函数
 233          入口参数：uiCount-延时参数
 234          返回值：无
 235          备注：无
 236          *******************************************************************************/
 237          void Delay(unsigned int uiCount)
 238          {
 239   1              while(uiCount--);
C51 COMPILER V9.60.0.0   MAIN                                                              12/23/2019 20:53:14 PAGE 5   

 240   1      }
 241          
 242          
 243          
 244          /****************end of line3**********************/
 245          /****************end of line2**********************/
 246          /****************end of line1**********************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    305    ----
   CONSTANT SIZE    =   1024    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
